import axios from "axios";

class FollowBtn {
  constructor() {
    this.btnWrapper = document.querySelector('.js-follow-page-wrapper');
    this.followCoinBtn = document.querySelector('.js-follow-page-btn');
    this.coinPageId = document.querySelector('.coin_page_id');
    this.location = window.location.origin;
  }

  listener() {
    if (this.btnWrapper) {
      this.followCoinBtn.addEventListener('click', node => {
        let status;
        if (this.followCoinBtn.classList.contains('b-btn--secondary')) {
          status = 0;
          this.followCoinBtn.innerHTML = `<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path class="reverse-icon-fill" d="M10.1331 2.66797C9.42589 2.66797 8.74762 2.94892 8.24752 3.44902C7.74742 3.94911 7.46647 4.62739 7.46647 5.33464C7.46647 6.04188 7.74742 6.72016 8.24752 7.22025C8.74762 7.72035 9.42589 8.0013 10.1331 8.0013C10.8404 8.0013 11.5187 7.72035 12.0188 7.22025C12.5189 6.72016 12.7998 6.04188 12.7998 5.33464C12.7998 4.62739 12.5189 3.94911 12.0188 3.44902C11.5187 2.94892 10.8404 2.66797 10.1331 2.66797ZM10.1331 3.93464C10.317 3.93464 10.499 3.97085 10.6689 4.0412C10.8387 4.11156 10.9931 4.21468 11.1231 4.34469C11.2531 4.47469 11.3562 4.62902 11.4266 4.79888C11.4969 4.96873 11.5331 5.15078 11.5331 5.33464C11.5331 5.51849 11.4969 5.70054 11.4266 5.87039C11.3562 6.04025 11.2531 6.19458 11.1231 6.32458C10.9931 6.45459 10.8387 6.55771 10.6689 6.62807C10.499 6.69842 10.317 6.73464 10.1331 6.73464C9.94929 6.73464 9.76724 6.69842 9.59738 6.62807C9.42752 6.55771 9.27319 6.45459 9.14319 6.32458C9.01319 6.19458 8.91006 6.04025 8.83971 5.87039C8.76935 5.70054 8.73314 5.51849 8.73314 5.33464C8.73314 4.96333 8.88064 4.60724 9.14319 4.34469C9.40574 4.08213 9.76183 3.93464 10.1331 3.93464ZM10.1331 8.66797C8.35314 8.66797 4.7998 9.55463 4.7998 11.3346V13.3346H15.4665V11.3346C15.4665 9.55463 11.9131 8.66797 10.1331 8.66797ZM10.1331 9.93463C12.1131 9.93463 14.1998 10.908 14.1998 11.3346V12.068H6.06647V11.3346C6.06647 10.908 8.13314 9.93463 10.1331 9.93463Z"/>
          <path class="reverse-icon-fill" d="M6.66667 5.74078L5.73333 4.80078L2.31333 8.24745L0.933333 6.86078L0 7.80078L2.31333 10.1341L6.66667 5.74078Z"/>
          </svg>  Following `;
          this.followCoinBtn.classList.remove('b-btn--secondary');
          this.followCoinBtn.classList.add('b-btn--primary');
        } else if (this.followCoinBtn.classList.contains('b-btn--primary')){
          status = 1;
          this.followCoinBtn.classList.remove('b-btn--primary');
          this.followCoinBtn.classList.add('b-btn--secondary');
          this.followCoinBtn.innerHTML = `<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9.99996 2.66675C9.29272 2.66675 8.61444 2.9477 8.11434 3.4478C7.61424 3.94789 7.33329 4.62617 7.33329 5.33341C7.33329 6.04066 7.61424 6.71894 8.11434 7.21903C8.61444 7.71913 9.29272 8.00008 9.99996 8.00008C10.7072 8.00008 11.3855 7.71913 11.8856 7.21903C12.3857 6.71894 12.6666 6.04066 12.6666 5.33341C12.6666 4.62617 12.3857 3.94789 11.8856 3.4478C11.3855 2.9477 10.7072 2.66675 9.99996 2.66675ZM9.99996 3.93341C10.1838 3.93341 10.3659 3.96963 10.5357 4.03998C10.7056 4.11034 10.8599 4.21346 10.9899 4.34347C11.1199 4.47347 11.223 4.6278 11.2934 4.79766C11.3637 4.96751 11.4 5.14956 11.4 5.33341C11.4 5.51727 11.3637 5.69932 11.2934 5.86917C11.223 6.03903 11.1199 6.19336 10.9899 6.32336C10.8599 6.45337 10.7056 6.55649 10.5357 6.62685C10.3659 6.6972 10.1838 6.73341 9.99996 6.73341C9.81611 6.73341 9.63406 6.6972 9.4642 6.62685C9.29435 6.55649 9.14001 6.45337 9.01001 6.32336C8.88001 6.19336 8.77688 6.03903 8.70653 5.86917C8.63617 5.69932 8.59996 5.51727 8.59996 5.33341C8.59996 4.96211 8.74746 4.60602 9.01001 4.34347C9.27256 4.08091 9.62866 3.93341 9.99996 3.93341ZM2.66663 4.66675V6.66675H0.666626V8.00008H2.66663V10.0001H3.99996V8.00008H5.99996V6.66675H3.99996V4.66675H2.66663ZM9.99996 8.66675C8.21996 8.66675 4.66663 9.55341 4.66663 11.3334V13.3334H15.3333V11.3334C15.3333 9.55341 11.78 8.66675 9.99996 8.66675ZM9.99996 9.93341C11.98 9.93341 14.0666 10.9067 14.0666 11.3334V12.0667H5.93329V11.3334C5.93329 10.9067 7.99996 9.93341 9.99996 9.93341Z"/>
          </svg>  Follow `;
        }
        axios
          .post(
            `${this.location}/v2/api/pages/followers?page_id=${this.coinPageId.value}`, {
              new_status: status,
            }
          );
      });
    }
  }

  init() {
    this.listener();
  }
}

export default FollowBtn;
